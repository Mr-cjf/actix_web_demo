#Build
FROM rust:1.88.0-slim as build-env

WORKDIR /app

# 复制依赖描述文件
COPY Cargo.toml Cargo.lock ./

# 复制 workspace 成员目录
COPY api_tool ./api_tool/
COPY route_codegen ./route_codegen/
COPY src ./src/

#Build the app
RUN cargo build --release

#Run
FROM debian

#Copy binary from the previous stage
COPY --from=build-env /app/target/release/web_demo /

#Actix port
EXPOSE 8080

#Start app
ENTRYPOINT ["/web_demo"]